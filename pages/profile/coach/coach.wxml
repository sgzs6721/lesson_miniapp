<!--coach.wxml-->
<view class="page">
  <view class="header">
    <view class="title">æ•™ç»ƒç®¡ç†</view>
  </view>

  <!-- æœç´¢å’Œæ·»åŠ åŒºåŸŸ -->
  <view class="search-add-container">
    <view class="search-box">
      <input type="text" placeholder="æœç´¢æ•™ç»ƒ" bindinput="onSearch" value="{{searchKey}}" />
      <view class="search-icon">ğŸ”</view>
    </view>
    <button class="add-btn" bindtap="showAddCoach">æ·»åŠ </button>
  </view>

  <!-- æ•™ç»ƒåˆ—è¡¨ -->
  <scroll-view class="coach-list" scroll-y>
    <view wx:if="{{coachList.length === 0}}" class="empty-tip">æš‚æ— æ•™ç»ƒ</view>
    <view wx:for="{{coachList}}" wx:key="id" class="coach-item">
      <view class="coach-info" bindtap="showCoachDetail" data-id="{{item.id}}">
        <image class="coach-avatar" src="{{item.avatar || '/images/default-avatar.png'}}"></image>
        <view class="coach-detail">
          <view class="coach-name">{{item.name}} <text class="coach-gender">{{item.gender === 'male' ? 'ç”·' : 'å¥³'}}</text></view>
          <view class="coach-meta">
            <text>{{item.phone}}</text>
            <text class="dot">Â·</text>
            <text>{{item.campus}}</text>
          </view>
          <view class="coach-courses">
            <text>{{item.courseCount}}é—¨è¯¾ç¨‹</text>
            <text class="dot">Â·</text>
            <text>{{item.studentCount}}åå­¦å‘˜</text>
          </view>
        </view>
      </view>
      <view class="coach-actions">
        <view class="action-btn edit" catchtap="editCoach" data-id="{{item.id}}">ç¼–è¾‘</view>
        <view class="action-btn delete" catchtap="deleteCoach" data-id="{{item.id}}">åˆ é™¤</view>
      </view>
    </view>
  </scroll-view>

  <!-- æ·»åŠ /ç¼–è¾‘æ•™ç»ƒå¼¹çª— -->
  <view class="modal {{showCoachModal ? 'show' : ''}}">
    <view class="modal-mask" bindtap="hideCoachModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text>{{editingCoach ? 'ç¼–è¾‘æ•™ç»ƒ' : 'æ·»åŠ æ•™ç»ƒ'}}</text>
        <view class="modal-close" bindtap="hideCoachModal">Ã—</view>
      </view>
      <view class="modal-body">
        <view class="form-item">
          <text class="label">å§“å</text>
          <input type="text" placeholder="è¯·è¾“å…¥æ•™ç»ƒå§“å" value="{{coachForm.name}}" bindinput="onCoachFormInput" data-field="name" />
        </view>
        <view class="form-item">
          <text class="label">æ€§åˆ«</text>
          <picker mode="selector" range="{{['ç”·', 'å¥³']}}" value="{{coachForm.genderIndex}}" bindchange="onGenderChange">
            <view class="picker">
              {{coachForm.gender === 'male' ? 'ç”·' : (coachForm.gender === 'female' ? 'å¥³' : 'è¯·é€‰æ‹©æ€§åˆ«')}}
            </view>
          </picker>
        </view>
        <view class="form-item">
          <text class="label">è”ç³»ç”µè¯</text>
          <input type="text" placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯" value="{{coachForm.phone}}" bindinput="onCoachFormInput" data-field="phone" />
        </view>
        <view class="form-item">
          <text class="label">æ‰€å±æ ¡åŒº</text>
          <picker mode="selector" range="{{campusList}}" range-key="name" value="{{coachForm.campusIndex}}" bindchange="onCampusChange">
            <view class="picker">
              {{coachForm.campus || 'è¯·é€‰æ‹©æ‰€å±æ ¡åŒº'}}
            </view>
          </picker>
        </view>
        <view class="form-item">
          <text class="label">æ•™å­¦ç§‘ç›®</text>
          <input type="text" placeholder="è¯·è¾“å…¥æ•™å­¦ç§‘ç›®" value="{{coachForm.subjects}}" bindinput="onCoachFormInput" data-field="subjects" />
        </view>
        <view class="form-item">
          <text class="label">ç®€ä»‹</text>
          <textarea placeholder="è¯·è¾“å…¥ç®€ä»‹" value="{{coachForm.intro}}" bindinput="onCoachFormInput" data-field="intro" />
        </view>
      </view>
      <view class="modal-footer">
        <button class="btn cancel" bindtap="hideCoachModal">å–æ¶ˆ</button>
        <button class="btn confirm" bindtap="saveCoach">ç¡®å®š</button>
      </view>
    </view>
  </view>

  <!-- æ•™ç»ƒè¯¦æƒ…å¼¹çª— -->
  <view class="modal {{showDetailModal ? 'show' : ''}}">
    <view class="modal-mask" bindtap="hideDetailModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text>æ•™ç»ƒè¯¦æƒ…</text>
        <view class="modal-close" bindtap="hideDetailModal">Ã—</view>
      </view>
      <view class="modal-body">
        <view class="detail-item">
          <text class="label">å§“å</text>
          <text class="value">{{currentCoach.name}}</text>
        </view>
        <view class="detail-item">
          <text class="label">æ€§åˆ«</text>
          <text class="value">{{currentCoach.gender === 'male' ? 'ç”·' : 'å¥³'}}</text>
        </view>
        <view class="detail-item">
          <text class="label">è”ç³»ç”µè¯</text>
          <text class="value">{{currentCoach.phone}}</text>
        </view>
        <view class="detail-item">
          <text class="label">æ‰€å±æ ¡åŒº</text>
          <text class="value">{{currentCoach.campus}}</text>
        </view>
        <view class="detail-item">
          <text class="label">æ•™å­¦ç§‘ç›®</text>
          <text class="value">{{currentCoach.subjects}}</text>
        </view>
        <view class="detail-item">
          <text class="label">è¯¾ç¨‹æ•°é‡</text>
          <text class="value">{{currentCoach.courseCount}}é—¨</text>
        </view>
        <view class="detail-item">
          <text class="label">å­¦å‘˜æ•°é‡</text>
          <text class="value">{{currentCoach.studentCount}}äºº</text>
        </view>
        <view class="detail-item">
          <text class="label">ç®€ä»‹</text>
          <text class="value">{{currentCoach.intro || 'æ— '}}</text>
        </view>
      </view>
      <view class="modal-footer">
        <button class="btn confirm" bindtap="hideDetailModal">å…³é—­</button>
      </view>
    </view>
  </view>
</view> 